{"version":3,"file":"edit_period.min.js","sources":["../src/edit_period.js"],"sourcesContent":["import * as Ajax from 'core/ajax';\nimport * as Str from 'core/str';\nimport * as notification from 'core/notification';\n\nexport const init = (learningid) => {\n    const btnsavenewperiod = document.querySelector('#save_new_period');\n    if (btnsavenewperiod) {\n        btnsavenewperiod.addEventListener('click', e => {\n            e.preventDefault();\n            const periodname = document.querySelector('#name_new_period');\n            const periodvigency = document.querySelector('#vigency_new_period');\n            if (!periodname.validity.valid) {\n                periodname.reportValidity();\n                return;\n            }\n            if (!periodvigency.validity.valid) {\n                periodvigency.reportValidity();\n                return;\n            }\n            const promise = Ajax.call([{\n                methodname: 'local_sc_learningplans_addperiod_learning_plan',\n                args: {\n                    learningplanid: learningid,\n                    name: periodname.value,\n                    vigency: periodvigency.value,\n                }\n            },]);\n\n            promise[0].done(function (response) {\n                window.console.log('local_sc_learningplans_addperiod_learning_plan', response);\n                window.location.reload(true);\n            }).fail(function (response) {\n                window.console.error(response);\n            });\n        });\n    }\n    const btndeleteperiod = document.querySelectorAll('#btndeleteperiod');\n    if (btndeleteperiod) {\n        for (const el of btndeleteperiod) {\n            const titleconfirm = Str.get_string('titleconfirm', 'local_sc_learningplans');\n            const msgconfirm = Str.get_string('msgconfirm_period', 'local_sc_learningplans');\n            const yesconfirm = Str.get_string('yesconfirm', 'local_sc_learningplans');\n            el.addEventListener('click', e => {\n                e.preventDefault();\n                const periodid = e.target.parentElement.getAttribute('period-id');\n                notification.saveCancel(titleconfirm, msgconfirm, yesconfirm, () => {\n                    callDeletePeriod(learningid, periodid);\n                });\n            });\n        }\n    }\n    const editperiod = document.querySelectorAll('.modalEditPeriod');\n    if (editperiod) {\n        for (const btnedit of editperiod) {\n            let periodid = btnedit.getAttribute('data-id');\n            const btnsavename = document.querySelector('#save_edit_period_' + periodid);\n            btnsavename.addEventListener('click', e => {\n                window.console.log(e);\n                let nameperiod = document.querySelector('#name_new_period_' + periodid).value;\n                let vigencyperiod = document.querySelector('#vigency_new_period_' + periodid).value;\n                callEditPeriod(periodid, nameperiod, vigencyperiod);\n            });\n        }\n    }\n};\nconst callDeletePeriod = (learningid, periodid) => {\n    learningid = parseInt(learningid);\n    periodid = parseInt(periodid);\n    const promise = Ajax.call([{\n        methodname: 'local_sc_learningplans_delete_period_learning_plan',\n        args: {\n            learningplan: learningid,\n            periodid: periodid,\n        }\n    },]);\n    promise[0].done(function (response) {\n        window.console.log('local_sc_learningplans_delete_period_learning_plan', response);\n        window.location.reload(true);\n    }).fail(function (response) {\n        window.console.error(response);\n    });\n};\n\nconst callEditPeriod = (periodid, nameperiod, vigencyperiod) => {\n    periodid = parseInt(periodid);\n    const promise = Ajax.call([{\n        methodname: 'local_sc_learningplans_edit_period_learning_plan',\n        args: {\n            periodid: periodid,\n            nameperiod: nameperiod,\n            vigency: vigencyperiod,\n        }\n    },]);\n    promise[0].done(function (response) {\n        window.console.log('local_sc_learningplans_edit_period_learning_plan', response);\n        window.location.reload(true);\n    }).fail(function (response) {\n        window.console.error(response);\n    });\n};"],"names":["learningid","btnsavenewperiod","document","querySelector","addEventListener","e","preventDefault","periodname","periodvigency","validity","valid","reportValidity","Ajax","call","methodname","args","learningplanid","name","value","vigency","done","response","window","console","log","location","reload","fail","error","btndeleteperiod","querySelectorAll","el","titleconfirm","Str","get_string","msgconfirm","yesconfirm","periodid","target","parentElement","getAttribute","notification","saveCancel","callDeletePeriod","editperiod","btnedit","nameperiod","vigencyperiod","callEditPeriod","parseInt","learningplan"],"mappings":"sxCAIqBA,mBACXC,iBAAmBC,SAASC,cAAc,oBAC5CF,kBACAA,iBAAiBG,iBAAiB,SAASC,IACvCA,EAAEC,uBACIC,WAAaL,SAASC,cAAc,oBACpCK,cAAgBN,SAASC,cAAc,2BACxCI,WAAWE,SAASC,kBACrBH,WAAWI,qBAGVH,cAAcC,SAASC,kBACxBF,cAAcG,iBAGFC,KAAKC,KAAK,CAAC,CACvBC,WAAY,iDACZC,KAAM,CACFC,eAAgBhB,WAChBiB,KAAMV,WAAWW,MACjBC,QAASX,cAAcU,UAIvB,GAAGE,MAAK,SAAUC,UACtBC,OAAOC,QAAQC,IAAI,iDAAkDH,UACrEC,OAAOG,SAASC,QAAO,MACxBC,MAAK,SAAUN,UACdC,OAAOC,QAAQK,MAAMP,sBAI3BQ,gBAAkB3B,SAAS4B,iBAAiB,uBAC9CD,oBACK,MAAME,MAAMF,gBAAiB,OACxBG,aAAeC,IAAIC,WAAW,eAAgB,0BAC9CC,WAAaF,IAAIC,WAAW,oBAAqB,0BACjDE,WAAaH,IAAIC,WAAW,aAAc,0BAChDH,GAAG3B,iBAAiB,SAASC,IACzBA,EAAEC,uBACI+B,SAAWhC,EAAEiC,OAAOC,cAAcC,aAAa,aACrDC,aAAaC,WAAWV,aAAcG,WAAYC,YAAY,KAC1DO,iBAAiB3C,WAAYqC,sBAKvCO,WAAa1C,SAAS4B,iBAAiB,uBACzCc,eACK,MAAMC,WAAWD,WAAY,KAC1BP,SAAWQ,QAAQL,aAAa,WAChBtC,SAASC,cAAc,qBAAuBkC,UACtDjC,iBAAiB,SAASC,IAClCiB,OAAOC,QAAQC,IAAInB,OACfyC,WAAa5C,SAASC,cAAc,oBAAsBkC,UAAUnB,MACpE6B,cAAgB7C,SAASC,cAAc,uBAAyBkC,UAAUnB,MAC9E8B,eAAeX,SAAUS,WAAYC,0BAK/CJ,iBAAmB,CAAC3C,WAAYqC,YAClCrC,WAAaiD,SAASjD,YACtBqC,SAAWY,SAASZ,UACJzB,KAAKC,KAAK,CAAC,CACvBC,WAAY,qDACZC,KAAM,CACFmC,aAAclD,WACdqC,SAAUA,aAGV,GAAGjB,MAAK,SAAUC,UACtBC,OAAOC,QAAQC,IAAI,qDAAsDH,UACzEC,OAAOG,SAASC,QAAO,MACxBC,MAAK,SAAUN,UACdC,OAAOC,QAAQK,MAAMP,cAIvB2B,eAAiB,CAACX,SAAUS,WAAYC,iBAC1CV,SAAWY,SAASZ,UACJzB,KAAKC,KAAK,CAAC,CACvBC,WAAY,mDACZC,KAAM,CACFsB,SAAUA,SACVS,WAAYA,WACZ3B,QAAS4B,kBAGT,GAAG3B,MAAK,SAAUC,UACtBC,OAAOC,QAAQC,IAAI,mDAAoDH,UACvEC,OAAOG,SAASC,QAAO,MACxBC,MAAK,SAAUN,UACdC,OAAOC,QAAQK,MAAMP"}