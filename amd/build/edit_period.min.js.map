{"version":3,"file":"edit_period.min.js","sources":["../src/edit_period.js"],"sourcesContent":["import * as Ajax from 'core/ajax';\nimport * as Str from 'core/str';\nimport * as notification from 'core/notification';\n\nexport const init = (learningid) => {\n    const btnsavenewperiod = document.querySelector('#save_new_period');\n    if (btnsavenewperiod) {\n        btnsavenewperiod.addEventListener('click', e => {\n            e.preventDefault();\n            const periodname = document.querySelector('#name_new_period');\n            const periodvigency = document.querySelector('#vigency_new_period');\n            const addSubperiodRadioButton = document.getElementById('addsubperiod');\n            if (!periodname.validity.valid) {\n                periodname.reportValidity();\n                return;\n            }\n            if (!periodvigency.validity.valid) {\n                periodvigency.reportValidity();\n                return;\n            }\n            const promise = Ajax.call([{\n                methodname: 'local_sc_learningplans_addperiod_learning_plan',\n                args: {\n                    learningplanid: learningid,\n                    name: periodname.value,\n                    vigency: periodvigency.value,\n                    hassubperiods: addSubperiodRadioButton.checked ? 1 : 0,\n                    subperiods:[]\n                }\n            },]);\n\n            promise[0].done(function (response) {\n                window.console.log('local_sc_learningplans_addperiod_learning_plan', response);\n                window.location.reload(true);\n            }).fail(function (response) {\n                window.console.error(response);\n            });\n        });\n    }\n    const btndeleteperiod = document.querySelectorAll('#btndeleteperiod');\n    if (btndeleteperiod) {\n        for (const el of btndeleteperiod) {\n            const titleconfirm = Str.get_string('titleconfirm', 'local_sc_learningplans');\n            const msgconfirm = Str.get_string('msgconfirm_period', 'local_sc_learningplans');\n            const yesconfirm = Str.get_string('yesconfirm', 'local_sc_learningplans');\n            el.addEventListener('click', e => {\n                e.preventDefault();\n                const periodid = e.target.parentElement.getAttribute('period-id');\n                notification.saveCancel(titleconfirm, msgconfirm, yesconfirm, () => {\n                    callDeletePeriod(learningid, periodid);\n                });\n            });\n        }\n    }\n    const editperiod = document.querySelectorAll('.modalEditPeriod');\n    if (editperiod) {\n        for (const btnedit of editperiod) {\n            let periodid = btnedit.getAttribute('data-id');\n            const btnsavename = document.querySelector('#save_edit_period_' + periodid);\n            btnsavename.addEventListener('click', e => {\n                window.console.log(e);\n                let nameperiod = document.querySelector('#name_new_period_' + periodid).value;\n                let vigencyperiod = document.querySelector('#vigency_new_period_' + periodid).value;\n                let hassubperiodsCheck = document.querySelector('#addsubperiod-' + periodid);\n                let hassubperiods = hassubperiodsCheck.checked ? 1 : 0\n                callEditPeriod(periodid, nameperiod, vigencyperiod, hassubperiods);\n            });\n        }\n    }\n};\nconst callDeletePeriod = (learningid, periodid) => {\n    learningid = parseInt(learningid);\n    periodid = parseInt(periodid);\n    const promise = Ajax.call([{\n        methodname: 'local_sc_learningplans_delete_period_learning_plan',\n        args: {\n            learningplan: learningid,\n            periodid: periodid,\n        }\n    },]);\n    promise[0].done(function (response) {\n        window.console.log('local_sc_learningplans_delete_period_learning_plan', response);\n        window.location.reload(true);\n    }).fail(function (response) {\n        window.console.error(response);\n    });\n};\n\nconst callEditPeriod = (periodid, nameperiod, vigencyperiod, hassubperiods) => {\n    periodid = parseInt(periodid);\n    const promise = Ajax.call([{\n        methodname: 'local_sc_learningplans_edit_period_learning_plan',\n        args: {\n            periodid: periodid,\n            nameperiod: nameperiod,\n            vigency: vigencyperiod,\n            hassubperiods: hassubperiods,\n            subperiods:[]\n            //------------------------------------------------------------------\n        }\n    },]);\n    promise[0].done(function (response) {\n        window.console.log('local_sc_learningplans_edit_period_learning_plan', response);\n        window.location.reload(true);\n    }).fail(function (response) {\n        window.console.error(response);\n    });\n};\ndocument.addEventListener('DOMContentLoaded', function () {\n  // Tu código JavaScript aquí\n  var modal = document.getElementById('editNamePeriod');\n  if (modal) {\n    modal.addEventListener('shown.bs.modal', function () {\n      // Simula un clic en el radio button con el id \"exampleRadios2\"\n      var radio = document.getElementById('exampleRadios2');\n      if (radio) {\n        radio.click();\n      }\n    });\n  }\n});\n\n\n\n\n\n"],"names":["learningid","btnsavenewperiod","document","querySelector","addEventListener","e","preventDefault","periodname","periodvigency","addSubperiodRadioButton","getElementById","validity","valid","reportValidity","Ajax","call","methodname","args","learningplanid","name","value","vigency","hassubperiods","checked","subperiods","done","response","window","console","log","location","reload","fail","error","btndeleteperiod","querySelectorAll","el","titleconfirm","Str","get_string","msgconfirm","yesconfirm","periodid","target","parentElement","getAttribute","notification","saveCancel","callDeletePeriod","editperiod","btnedit","nameperiod","vigencyperiod","callEditPeriod","parseInt","learningplan","modal","radio","click"],"mappings":"sxCAIqBA,mBACXC,iBAAmBC,SAASC,cAAc,oBAC5CF,kBACAA,iBAAiBG,iBAAiB,SAASC,IACvCA,EAAEC,uBACIC,WAAaL,SAASC,cAAc,oBACpCK,cAAgBN,SAASC,cAAc,uBACvCM,wBAA0BP,SAASQ,eAAe,oBACnDH,WAAWI,SAASC,kBACrBL,WAAWM,qBAGVL,cAAcG,SAASC,kBACxBJ,cAAcK,iBAGFC,KAAKC,KAAK,CAAC,CACvBC,WAAY,iDACZC,KAAM,CACFC,eAAgBlB,WAChBmB,KAAMZ,WAAWa,MACjBC,QAASb,cAAcY,MACvBE,cAAeb,wBAAwBc,QAAU,EAAI,EACrDC,WAAW,OAIX,GAAGC,MAAK,SAAUC,UACtBC,OAAOC,QAAQC,IAAI,iDAAkDH,UACrEC,OAAOG,SAASC,QAAO,MACxBC,MAAK,SAAUN,UACdC,OAAOC,QAAQK,MAAMP,sBAI3BQ,gBAAkBhC,SAASiC,iBAAiB,uBAC9CD,oBACK,MAAME,MAAMF,gBAAiB,OACxBG,aAAeC,IAAIC,WAAW,eAAgB,0BAC9CC,WAAaF,IAAIC,WAAW,oBAAqB,0BACjDE,WAAaH,IAAIC,WAAW,aAAc,0BAChDH,GAAGhC,iBAAiB,SAASC,IACzBA,EAAEC,uBACIoC,SAAWrC,EAAEsC,OAAOC,cAAcC,aAAa,aACrDC,aAAaC,WAAWV,aAAcG,WAAYC,YAAY,KAC1DO,iBAAiBhD,WAAY0C,sBAKvCO,WAAa/C,SAASiC,iBAAiB,uBACzCc,eACK,MAAMC,WAAWD,WAAY,KAC1BP,SAAWQ,QAAQL,aAAa,WAChB3C,SAASC,cAAc,qBAAuBuC,UACtDtC,iBAAiB,SAASC,IAClCsB,OAAOC,QAAQC,IAAIxB,OACf8C,WAAajD,SAASC,cAAc,oBAAsBuC,UAAUtB,MACpEgC,cAAgBlD,SAASC,cAAc,uBAAyBuC,UAAUtB,MAE1EE,cADqBpB,SAASC,cAAc,iBAAmBuC,UAC5BnB,QAAU,EAAI,EACrD8B,eAAeX,SAAUS,WAAYC,cAAe9B,0BAK9D0B,iBAAmB,CAAChD,WAAY0C,YAClC1C,WAAasD,SAAStD,YACtB0C,SAAWY,SAASZ,UACJ5B,KAAKC,KAAK,CAAC,CACvBC,WAAY,qDACZC,KAAM,CACFsC,aAAcvD,WACd0C,SAAUA,aAGV,GAAGjB,MAAK,SAAUC,UACtBC,OAAOC,QAAQC,IAAI,qDAAsDH,UACzEC,OAAOG,SAASC,QAAO,MACxBC,MAAK,SAAUN,UACdC,OAAOC,QAAQK,MAAMP,cAIvB2B,eAAiB,CAACX,SAAUS,WAAYC,cAAe9B,iBACzDoB,SAAWY,SAASZ,UACJ5B,KAAKC,KAAK,CAAC,CACvBC,WAAY,mDACZC,KAAM,CACFyB,SAAUA,SACVS,WAAYA,WACZ9B,QAAS+B,cACT9B,cAAeA,cACfE,WAAW,OAIX,GAAGC,MAAK,SAAUC,UACtBC,OAAOC,QAAQC,IAAI,mDAAoDH,UACvEC,OAAOG,SAASC,QAAO,MACxBC,MAAK,SAAUN,UACdC,OAAOC,QAAQK,MAAMP,cAG7BxB,SAASE,iBAAiB,oBAAoB,eAExCoD,MAAQtD,SAASQ,eAAe,kBAChC8C,OACFA,MAAMpD,iBAAiB,kBAAkB,eAEnCqD,MAAQvD,SAASQ,eAAe,kBAChC+C,OACFA,MAAMC"}