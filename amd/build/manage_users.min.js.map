{"version":3,"file":"manage_users.min.js","sources":["../src/manage_users.js"],"sourcesContent":["import * as notification from 'core/notification';\nimport * as Str from 'core/str';\nimport * as Ajax from 'core/ajax';\n\nexport const init = (learningplanid) => {\n    addUserAction(learningplanid);\n    deleteUserAction(learningplanid);\n};\n\nconst deleteUserAction = (learningplanid) => {\n    const deletebtn = document.querySelectorAll('.btn.deleteuser');\n    const titleconfirm = Str.get_string('titleconfirm', 'local_sc_learningplans');\n    const msgconfirm = Str.get_string('msgconfirm_user', 'local_sc_learningplans');\n    const yesconfirm = Str.get_string('yesconfirm', 'local_sc_learningplans');\n    deletebtn.forEach(el => {\n        el.addEventListener('click', e => {\n            e.preventDefault();\n            const userid = e.target.parentElement.getAttribute('userid');\n            notification.saveCancel(titleconfirm, msgconfirm, yesconfirm, () => {\n                const removeenrol = document.querySelector('#checkRemoveCourses');\n                window.console.log(removeenrol, removeenrol.checked);\n                callDeleteUser(learningplanid, userid, removeenrol ? removeenrol.checked : false);\n            });\n        });\n    });\n};\n\nconst addUserAction = (learningplanid) => {\n    const userselected = document.querySelector('#listusers');\n    const itemvalue = document.querySelector('#listusers-hidden');\n    const roleselected = document.querySelector('#listroles');\n    userselected.addEventListener('change', () => {\n        const val = userselected.value;\n        const userList = document.querySelector(`#users-list option[value='${val}']`);\n        if (userList) {\n            itemvalue.value = userList.getAttribute('data-id');\n        }\n    });\n\n    const btnadduser = document.querySelector('#adduser');\n    if (btnadduser) {\n        btnadduser.addEventListener('click', e => {\n            e.preventDefault();\n            if (userselected && roleselected) {\n                const userid = itemvalue.value;\n                const roleid = roleselected.value;\n                callAddUser(learningplanid, userid, roleid);\n            }\n        });\n    }\n};\n\nconst callDeleteUser = (learningplan, userid, unenrol) => {\n    learningplan = parseInt(learningplan);\n    userid = parseInt(userid);\n    const promise = Ajax.call([{\n        methodname: 'local_sc_learningplans_delete_learning_user',\n        args: {\n            learningplan,\n            userid,\n            unenrol,\n        }\n    },]);\n\n    promise[0].done(function (response) {\n        window.console.log('local_sc_learningplans_delete_learning_user', response);\n        window.location.reload();\n    }).fail(function (response) {\n        window.console.error(response);\n    });\n};\n\nconst callAddUser = (learningplan, userid, roleid) => {\n    learningplan = parseInt(learningplan);\n    userid = parseInt(userid);\n    roleid = parseInt(roleid);\n    const promise = Ajax.call([{\n        methodname: 'local_sc_learningplans_add_learning_user',\n        args: {\n            learningplan,\n            userid,\n            roleid,\n        }\n    },]);\n\n    promise[0].done(function (response) {\n        window.console.log('local_sc_learningplans_add_learning_user', response);\n        window.location.reload();\n    }).fail(function (response) {\n        window.console.error(response);\n    });\n};"],"names":["learningplanid","addUserAction","deleteUserAction","deletebtn","document","querySelectorAll","titleconfirm","Str","get_string","msgconfirm","yesconfirm","forEach","el","addEventListener","e","preventDefault","userid","target","parentElement","getAttribute","notification","saveCancel","removeenrol","querySelector","window","console","log","checked","callDeleteUser","userselected","itemvalue","roleselected","val","value","userList","btnadduser","roleid","callAddUser","learningplan","unenrol","parseInt","Ajax","call","methodname","args","done","response","location","reload","fail","error"],"mappings":"oiDAIoB,SAACA,gBACjBC,cAAcD,gBACdE,iBAAiBF,qBAGfE,iBAAmB,SAACF,oBAChBG,UAAYC,SAASC,iBAAiB,mBACtCC,aAAeC,IAAIC,WAAW,eAAgB,0BAC9CC,WAAaF,IAAIC,WAAW,kBAAmB,0BAC/CE,WAAaH,IAAIC,WAAW,aAAc,0BAChDL,UAAUQ,SAAQ,SAAAC,IACdA,GAAGC,iBAAiB,SAAS,SAAAC,GACzBA,EAAEC,qBACIC,OAASF,EAAEG,OAAOC,cAAcC,aAAa,UACnDC,aAAaC,WAAWf,aAAcG,WAAYC,YAAY,eACpDY,YAAclB,SAASmB,cAAc,uBAC3CC,OAAOC,QAAQC,IAAIJ,YAAaA,YAAYK,SAC5CC,eAAe5B,eAAgBgB,SAAQM,aAAcA,YAAYK,mBAM3E1B,cAAgB,SAACD,oBACb6B,aAAezB,SAASmB,cAAc,cACtCO,UAAY1B,SAASmB,cAAc,qBACnCQ,aAAe3B,SAASmB,cAAc,cAC5CM,aAAahB,iBAAiB,UAAU,eAC9BmB,IAAMH,aAAaI,MACnBC,SAAW9B,SAASmB,kDAA2CS,WACjEE,WACAJ,UAAUG,MAAQC,SAASf,aAAa,mBAI1CgB,WAAa/B,SAASmB,cAAc,YACtCY,YACAA,WAAWtB,iBAAiB,SAAS,SAAAC,MACjCA,EAAEC,iBACEc,cAAgBE,aAAc,KACxBf,OAASc,UAAUG,MACnBG,OAASL,aAAaE,MAC5BI,YAAYrC,eAAgBgB,OAAQoB,aAM9CR,eAAiB,SAACU,aAActB,OAAQuB,SAC1CD,aAAeE,SAASF,cACxBtB,OAASwB,SAASxB,QACFyB,KAAKC,KAAK,CAAC,CACvBC,WAAY,8CACZC,KAAM,CACFN,aAAAA,aACAtB,OAAAA,OACAuB,QAAAA,YAIA,GAAGM,MAAK,SAAUC,UACtBtB,OAAOC,QAAQC,IAAI,8CAA+CoB,UAClEtB,OAAOuB,SAASC,YACjBC,MAAK,SAAUH,UACdtB,OAAOC,QAAQyB,MAAMJ,cAIvBT,YAAc,SAACC,aAActB,OAAQoB,QACvCE,aAAeE,SAASF,cACxBtB,OAASwB,SAASxB,QAClBoB,OAASI,SAASJ,QACFK,KAAKC,KAAK,CAAC,CACvBC,WAAY,2CACZC,KAAM,CACFN,aAAAA,aACAtB,OAAAA,OACAoB,OAAAA,WAIA,GAAGS,MAAK,SAAUC,UACtBtB,OAAOC,QAAQC,IAAI,2CAA4CoB,UAC/DtB,OAAOuB,SAASC,YACjBC,MAAK,SAAUH,UACdtB,OAAOC,QAAQyB,MAAMJ"}