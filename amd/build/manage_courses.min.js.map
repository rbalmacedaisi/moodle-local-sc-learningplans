{"version":3,"file":"manage_courses.min.js","sources":["../src/manage_courses.js"],"sourcesContent":["import * as notification from 'core/notification';\nimport * as Str from 'core/str';\nimport * as Ajax from 'core/ajax';\n\nconst addCoursePeriodSelector = document.getElementById('selectPeriodToLearningPlan');\nconst addCourseSubPeriodSelectorContainer =  document.getElementById('selectSubPeriodToLearningPlanContainer');\nconst addCourseSubPeriodSelector =document.getElementById('selectSubPeriodToLearningPlan');\n\nlet learnigplanPeriods;\n\nexport const init = (learningplanid, periods) => {\n    learnigplanPeriods = periods\n    \n    deleteCourseAction(learningplanid);\n    addCoursePeriodAction(learningplanid);\n    addRequiredAction(learningplanid);\n    addOptionalAction(learningplanid);\n    changeOptionalToRequiredAction(learningplanid);\n    updateCoursePositionAction();\n    actionAddCourseRelations();\n};\n\nlet actionAddCourseRelations = () => {\n    const allBtn = document.querySelectorAll('#btnAddRelationCourse');\n    allBtn.forEach(element => {\n        element.addEventListener('click', () => {\n            const recordid = element.getAttribute('course-record-id');\n            window.lastRecordId = recordid;\n            callGetPossibleRelations(recordid);\n        });\n    });\n    const allRemoveBtn = document.querySelectorAll('#btnDeleteRelationCourse');\n    allRemoveBtn.forEach(element => {\n        element.addEventListener('click', () => {\n            const recordid = element.getAttribute('course-record-id');\n            window.lastRecordId = recordid;\n            callGetPossibleRelations(recordid, true);\n        });\n    });\n\n    const closerelation = document.querySelector('#closerelation');\n    if (closerelation) {\n        closerelation.addEventListener('click', () => {\n            const modal = document.getElementById('coursesRelatedModal');\n            modal.classList.remove('show');\n            modal.style.display = 'none';\n        });\n    }\n\n    const addrelation = document.querySelector('#addrelation');\n    if (addrelation) {\n        addrelation.addEventListener('click', () => {\n            const select = document.querySelector('#selectCourseToRelated');\n            if (select) {\n                const selectedOptions = select.selectedOptions;\n                const selectedValues = [];\n                for (let i = 0; i < selectedOptions.length; i++) {\n                    selectedValues.push(selectedOptions[i].value);\n                }\n                const records = selectedValues.join(',');\n                const recordid = window.lastRecordId;\n                if (window.getToRemove) {\n                    callRemoveRelations(recordid, records);\n                } else {\n                    callAddRelations(recordid, records);\n                }\n            }\n        });\n    }\n\n    const delcloserelation = document.querySelector('#delcloserelation');\n    if (delcloserelation) {\n        delcloserelation.addEventListener('click', () => {\n            const modal = document.getElementById('coursesDelRelatedModal');\n            modal.classList.remove('show');\n            modal.style.display = 'none';\n        });\n    }\n\n    const delrelation = document.querySelector('#delrelation');\n    if (delrelation) {\n        delrelation.addEventListener('click', () => {\n            const select = document.querySelector('#selectCourseToDelRelated');\n            if (select) {\n                const selectedOptions = select.selectedOptions;\n                const selectedValues = [];\n                for (let i = 0; i < selectedOptions.length; i++) {\n                    selectedValues.push(selectedOptions[i].value);\n                }\n                const records = selectedValues.join(',');\n                const recordid = window.lastRecordId;\n                callRemoveRelations(recordid, records);\n            }\n        });\n    }\n};\n\nconst callRemoveRelations = (recordid, records) => {\n    const promise = Ajax.call([{\n        methodname: 'local_sc_learningplans_del_course_relations',\n        args: {\n            recordid,\n            records,\n        }\n    },]);\n\n    promise[0].done(function (response) {\n        window.console.log('local_sc_learningplans_del_course_relations', response);\n        location.reload();\n    }).fail(function (response) {\n        window.console.error(response);\n    });\n};\n\nconst callAddRelations = (recordid, records) => {\n    const promise = Ajax.call([{\n        methodname: 'local_sc_learningplans_add_course_relations',\n        args: {\n            recordid,\n            records,\n        }\n    },]);\n\n    promise[0].done(function (response) {\n        window.console.log('local_sc_learningplans_add_course_relations', response);\n        location.reload();\n    }).fail(function (response) {\n        window.console.error(response);\n    });\n};\n\nconst callGetPossibleRelations = (recordid, getToRemove = false) => {\n    recordid = parseInt(recordid);\n    const promise = Ajax.call([{\n        methodname: 'local_sc_learningplans_get_possible_relations',\n        args: {\n            recordid,\n        }\n    },]);\n\n    promise[0].done(function (response) {\n        window.console.log('local_sc_learningplans_get_possible_relations', response);\n        window.getToRemove = getToRemove;\n        let dataCourses = response.courses;\n        let selectCourses;\n        let modal;\n        if (getToRemove) {\n            modal = document.getElementById('coursesDelRelatedModal');\n            dataCourses = response.current;\n            selectCourses = document.querySelector('#selectCourseToDelRelated');\n        }\n        else {\n            modal = document.getElementById('coursesRelatedModal');\n            selectCourses = document.querySelector('#selectCourseToRelated');\n        }\n        selectCourses.innerHTML = '';\n        dataCourses.forEach(element => {\n            const newElement = document.createElement(\"option\");\n            newElement.value = element.recordid;\n            newElement.append(element.coursename);\n            selectCourses.append(newElement);\n        });\n\n        modal.classList.add('show');\n        modal.style.display = 'block';\n    }).fail(function (response) {\n        window.console.error(response);\n    });\n};\n\nlet deleteCourseAction = (learningplanid) => {\n    const deleteBtns = document.querySelectorAll('#btndeletecourse');\n    if (deleteBtns) {\n        const titleconfirm = Str.get_string('titleconfirm', 'local_sc_learningplans');\n        const msgconfirm = Str.get_string('msgconfirm_course', 'local_sc_learningplans');\n        const yesconfirm = Str.get_string('yesconfirm', 'local_sc_learningplans');\n        for (const el of deleteBtns) {\n            el.addEventListener('click', e => {\n                e.preventDefault();\n                const course_record_id = el.getAttribute('course-record-id');\n                const isrequired = el.getAttribute('course-required');\n                notification.saveCancel(titleconfirm, msgconfirm, yesconfirm, () => {\n                    callDeleteCourse(learningplanid, course_record_id, isrequired);\n                });\n            });\n        }\n    }\n};\n\nlet addCoursePeriodAction = (learningplanid) => {\n    const btnaddcourses = document.querySelector('#addcourses');\n    if (btnaddcourses) {\n        btnaddcourses.addEventListener('click', e => {\n            e.preventDefault();\n            const courseselected = document.getElementById('selectAddCourseToLearningPlanPeriod').selectedOptions;\n            const periodselected = document.getElementById('selectPeriodToLearningPlan').value;\n            const creditselected = -1;\n            let isrequired = 0;\n            if (document.getElementById('required').checked) {\n                isrequired = 1;\n            } else {\n                isrequired = 0;\n            }\n            if (courseselected) {\n                const datacourses = Array.prototype.slice.call(courseselected);\n                const courseid = datacourses.map(select => select.value).join(',');\n                callAddCourse(learningplanid, periodselected, courseid, isrequired, creditselected);\n            }\n        });\n    }\n    \n    \n    addCoursePeriodSelector.addEventListener('change', e=>{\n        addCourseSubPeriodSelector.value = \"0\"\n        // Get a reference to all elements with the specified class name\n        const elementsToRemove = document.getElementsByClassName(\"subperiods\");\n        \n        // Loop through the elements and remove them\n        while (elementsToRemove.length > 0) {\n          const element = elementsToRemove[0];\n          element.parentNode.removeChild(element);\n        }\n\n        if(learnigplanPeriods[e.target.value].hassubperiods ===\"1\"){\n            let subperiods = learnigplanPeriods[e.target.value].subperiods\n            for (const subperiodid in subperiods) {\n                if (Object.hasOwnProperty.call(subperiods, subperiodid)) {\n                    const subperiod = subperiods[subperiodid];\n                    const option = document.createElement(\"option\");\n                    option.text = subperiod.name;\n                    option.className = \"subperiods\";\n                    option.value=subperiod.id;\n                    addCourseSubPeriodSelector.appendChild(option);\n                }\n            }\n            addCourseSubPeriodSelectorContainer.classList.remove(\"d-none\");\n        } else {\n            addCourseSubPeriodSelectorContainer.classList.add(\"d-none\");\n        }\n    })\n};\n\nlet addRequiredAction = (learningplanid) => {\n    const btnaddrequired = document.querySelector('#addrequired');\n    if (btnaddrequired) {\n        btnaddrequired.addEventListener('click', e => {\n            e.preventDefault();\n            const courseselected = document.getElementById('selectAddCourseToLearningPlan').selectedOptions;\n            if (courseselected) {\n                const datacourses = Array.prototype.slice.call(courseselected);\n                const courseid = datacourses.map(select => select.value).join(',');\n                callAddCourse(learningplanid, null, courseid, 1, -1);\n            }\n        });\n    }\n};\n\nlet addOptionalAction = (learningplanid) => {\n    const btnaddooptional = document.querySelector('#addOptional');\n    if (btnaddooptional) {\n        btnaddooptional.addEventListener('click', e => {\n            e.preventDefault();\n            const courseselected = document.getElementById('selectAddCourseOptionalToLearningPlan').selectedOptions;\n            if (courseselected) {\n                const datacourses = Array.prototype.slice.call(courseselected);\n                const courseid = datacourses.map(select => select.value).join(',');\n                callAddCourse(learningplanid, null, courseid, 0, -1);\n            }\n        });\n    }\n};\n\nlet changeOptionalToRequiredAction = (learningplanid) => {\n    const addoptionalrequired = document.querySelectorAll('#addoptional_required');\n    if (addoptionalrequired) {\n        const titleconfirm = Str.get_string('titleconfirmmove', 'local_sc_learningplans');\n        const yesconfirm = Str.get_string('yesmmoveconfirm', 'local_sc_learningplans');\n        for (const add of addoptionalrequired) {\n            const coursename = add.getAttribute('cname');\n            const msgconfirm = Str.get_string('msgconfirm_mmove', 'local_sc_learningplans', { cname: coursename });\n            add.addEventListener('click', e => {\n                e.preventDefault();\n                const course_record_id = add.getAttribute('course-record-id');\n                const credits = add.getAttribute('credits') ?? -1;\n                const periodid = add.getAttribute('periodid') ?? null;\n                if (course_record_id) {\n                    const recordid = course_record_id;\n                    notification.saveCancel(titleconfirm, msgconfirm, yesconfirm, () => {\n                        callDeleteCourse(learningplanid, recordid, 0, false, credits, periodid, add.getAttribute('course-id'));\n                    });\n                }\n            });\n        }\n    }\n};\n\n\nconst callUpdateCourse = (learningid, courseorder, periodid = null, reload = true) => {\n    learningid = parseInt(learningid);\n    const promise = Ajax.call([{\n        methodname: 'local_sc_learningplans_update_required_learning_courses',\n        args: {\n            learningplan: learningid,\n            courseorder,\n            periodid\n        }\n    },]);\n\n    promise[0].done(function (response) {\n        window.console.log('local_sc_learningplans_update_required_learning_courses', response);\n        if(reload) {\n            location.reload();\n        }\n    }).fail(function (response) {\n        window.console.error(response);\n    });\n};\n\nconst callAddCourse = (learningid, periodid, courseid, isrequired, credits) => {\n    learningid = parseInt(learningid);\n    isrequired = parseInt(isrequired);\n    \n    const promise = Ajax.call([{\n        methodname: 'local_sc_learningplans_save_learning_course',\n        args: {\n            learningplan: learningid,\n            periodid,\n            subperiodid : addCourseSubPeriodSelector.value,\n            courseid,\n            required: isrequired,\n            credits: credits,\n        }\n    },]);\n\n    promise[0].done(function (response) {\n        window.console.log('local_sc_learningplans_save_learning_course', response);\n        window.location.reload();\n    }).fail(function (response) {\n        window.console.error(response);\n    });\n};\n\nconst callDeleteCourse = (\n    learningid, recordid, isrequired, notaddingcourse = true, credits = -1, periodid = null, courseid = null\n) => {\n    learningid = parseInt(learningid);\n    recordid = parseInt(recordid);\n    isrequired = parseInt(isrequired);\n    const promise = Ajax.call([{\n        methodname: 'local_sc_learningplans_delete_learning_course',\n        args: {\n            learningplan: learningid,\n            courseid: recordid,\n            required: isrequired,\n        }\n    },]);\n\n    promise[0].done(function (response) {\n        window.console.log('local_sc_learningplans_delete_learning_course', response);\n        if (notaddingcourse) {\n            window.location.reload();\n        }\n        else {\n            callAddCourse(learningid, periodid, courseid, 1, credits);\n        }\n\n    }).fail(function (response) {\n        window.console.error(response);\n    });\n};\n\nlet items = document.querySelectorAll('.list-courses-required');\nlet itemsPeriod = document.querySelectorAll('.tab-pane .list-courses-required-period');\nlet containercourses = document.querySelectorAll('.coursesrequired');\n\nconst updateCoursePositionAction = () => {\n    const btnupdatecourseorder = document.querySelector('#updatecourseorder');\n\n    items.forEach(function (item) {\n        item.addEventListener('dragstart', handleDragStart, false);\n        item.addEventListener('dragenter', handleDragEnter, false);\n        item.addEventListener('dragover', handleDragOver, false);\n        item.addEventListener('dragleave', handleDragLeave, false);\n        item.addEventListener('drop', handleDrop, false);\n        item.addEventListener('dragend', handleDragEnd, false);\n    });\n\n    itemsPeriod.forEach(function (item) {\n        item.addEventListener('dragstart', handleDragStart, false);\n        item.addEventListener('dragenter', handleDragEnter, false);\n        item.addEventListener('dragover', handleDragOver, false);\n        item.addEventListener('dragleave', handleDragLeave, false);\n        item.addEventListener('drop', handleDrop, false);\n        item.addEventListener('dragend', handleDragEnd, false);\n    });\n\n    containercourses.forEach(function (contelement) {\n        contelement.addEventListener('dragenter', handleDragEnter, false);\n        contelement.addEventListener('dragleave', handleDragLeave, false);\n        contelement.addEventListener('dragover', handleDragOver, false);\n        contelement.addEventListener('drop', handleDropNew, false);\n    });\n\n    if (btnupdatecourseorder) {\n        const lpid = document.querySelector(\".coursesrequired\");\n        let learningplanid = lpid.getAttribute('learningplanid');\n        btnupdatecourseorder.addEventListener('click', e => {\n            e.preventDefault();\n            clickUpdateCourses(learningplanid);\n        });\n    }\n\n    const btnupdatecourseperiodorder = document.querySelectorAll('#courseOrderInPeriod');\n    for (const btnupdate of btnupdatecourseperiodorder) {\n        btnupdate.addEventListener('click', e => {\n            e.preventDefault();\n            let periodid = btnupdate.attributes.periodid.value;\n            let lpid = btnupdate.attributes.lpid.value;\n            clickUpdateCoursePeriod(lpid, periodid);\n        });\n    }\n};\n\nconst clickUpdateCoursePeriod = (lpid, periodid, reload) => {\n    const itemsPeriod = document.querySelectorAll(`li[lpid=\"${lpid}\"][periodid=\"${periodid}\"]`);\n    const courseData = [];\n    itemsPeriod.forEach(function (item) {\n        let listRecordID = item.attributes.datacourse.value;\n        let listCoursePosition = item.attributes.poscourse.value;\n        let listCourseID = item.attributes.courseid.value;\n        courseData.push({\n            recordid: listRecordID.replace('courses[', '').replace(']', ''),\n            position: listCoursePosition,\n            courseid: listCourseID,\n        });\n    });\n    const coursePosition = [];\n    courseData.forEach((index) => {\n        coursePosition.push({\n            recordid: index.recordid,\n            courseid: index.courseid,\n            position: index.position,\n            periodid: index.periodid\n        });\n    });\n    callUpdateCourse(lpid, coursePosition, periodid, reload);\n};\n\nconst clickUpdateCourses = (learningplanid) => {\n    const courseData = [];\n    items.forEach(function (item) {\n        let listRecordID = item.attributes.datacourse.value;\n        let listCoursePosition = item.attributes.poscourse.value;\n        let listCourseID = item.attributes.courseid.value;\n        courseData.push({\n            recordid: listRecordID.replace('courses[', '').replace(']', ''),\n            position: listCoursePosition,\n            courseid: listCourseID,\n        });\n    });\n\n    const coursePosition = [];\n    courseData.forEach((index) => {\n        coursePosition.push({\n            recordid: index.recordid,\n            courseid: index.courseid,\n            position: index.position,\n            periodid: index.periodid\n        });\n    });\n    callUpdateCourse(learningplanid, coursePosition);\n};\n\nvar dragSrcEl = null;\n\n/**\n *\n * @param {*} e\n */\nfunction handleDragStart(e) {\n    this.style.opacity = '0.4';\n\n    dragSrcEl = this;\n\n    e.dataTransfer.effectAllowed = 'move';\n    e.dataTransfer.setData('text/html', this.innerHTML);\n}\n\n/**\n *\n * @param {*} e\n */\nfunction handleDragOver(e) {\n    if (e.preventDefault) {\n        e.preventDefault();\n    }\n\n    e.dataTransfer.dropEffect = 'move';\n\n    return false;\n}\n\n/**\n *\n */\nfunction handleDragEnter() {\n    this.classList.add('over');\n}\n\n/**\n *\n */\nfunction handleDragLeave() {\n    this.classList.remove('over');\n}\n\n/**\n *\n * @param {*} e\n */\nfunction handleDrop(e) {\n    if (e.stopPropagation) {\n        e.stopPropagation(); // stops the browser from redirecting.\n    }\n    if (dragSrcEl != this) {\n        dragSrcEl.innerHTML = this.innerHTML;\n        this.innerHTML = e.dataTransfer.getData('text/html');\n\n        let itemToReplaceAttr = this.attributes[\"datacourse\"].value;\n        let itemToReplaceCourseAttr = this.attributes[\"courseid\"].value;\n        let draggedItemAttr = dragSrcEl.attributes[\"datacourse\"].value;\n        let draggedItemCourseAttr = dragSrcEl.attributes[\"courseid\"].value;\n        this.setAttribute(\"datacourse\", draggedItemAttr);\n        this.setAttribute(\"courseid\", draggedItemCourseAttr);\n        dragSrcEl.setAttribute(\"datacourse\", itemToReplaceAttr);\n        dragSrcEl.setAttribute(\"courseid\", itemToReplaceCourseAttr);\n        const lpid = document.querySelector(\".coursesrequired\");\n        let learningplanid = lpid.getAttribute('learningplanid');\n        let havePeriod = dragSrcEl.attributes['periodid']?.value;\n        if (havePeriod) {\n            const allPeriodsRequired = document.querySelectorAll('.coursesrequired');\n            allPeriodsRequired.forEach(el => {\n                const periodid = el.getAttribute('record-periodid');\n                window.console.log(periodid);\n                clickUpdateCoursePeriod(learningplanid, periodid, false);\n            });\n        } else {\n            clickUpdateCourses(learningplanid);\n        }\n        window.console.log(learningplanid, havePeriod,\n            'Cambiando los cursos draggedItemAttr: ',\n            draggedItemAttr, 'itemToReplaceAttr', itemToReplaceAttr);\n    }\n\n    return false;\n}\n\n/**\n *\n * @param {*} e\n */\nfunction handleDropNew(e) {\n    if (e.stopPropagation) {\n        e.stopPropagation(); // stops the browser from redirecting.\n    }\n    const dragParent = dragSrcEl.parentElement;\n    if (dragParent != e.target) {\n        e.target.append(dragSrcEl);\n    }\n    return false;\n}\n\n/**\n *\n */\nfunction handleDragEnd() {\n    this.style.opacity = '1';\n    items.forEach(function (item) {\n        item.classList.remove('over');\n    });\n    containercourses.forEach(function (item) {\n        item.classList.remove('over');\n    });\n}"],"names":["addCoursePeriodSelector","document","getElementById","addCourseSubPeriodSelectorContainer","addCourseSubPeriodSelector","learnigplanPeriods","learningplanid","periods","deleteCourseAction","addCoursePeriodAction","addRequiredAction","addOptionalAction","changeOptionalToRequiredAction","updateCoursePositionAction","actionAddCourseRelations","querySelectorAll","forEach","element","addEventListener","recordid","getAttribute","window","lastRecordId","callGetPossibleRelations","closerelation","querySelector","modal","classList","remove","style","display","addrelation","select","selectedOptions","selectedValues","i","length","push","value","records","join","getToRemove","callRemoveRelations","callAddRelations","delcloserelation","delrelation","Ajax","call","methodname","args","done","response","console","log","location","reload","fail","error","parseInt","promise","selectCourses","dataCourses","courses","current","innerHTML","newElement","createElement","append","coursename","add","deleteBtns","titleconfirm","Str","get_string","msgconfirm","yesconfirm","el","e","preventDefault","course_record_id","isrequired","notification","saveCancel","callDeleteCourse","btnaddcourses","courseselected","periodselected","checked","courseid","Array","prototype","slice","map","callAddCourse","elementsToRemove","getElementsByClassName","parentNode","removeChild","target","hassubperiods","subperiods","subperiodid","Object","hasOwnProperty","subperiod","option","text","name","className","id","appendChild","btnaddrequired","btnaddooptional","addoptionalrequired","cname","credits","periodid","callUpdateCourse","learningid","courseorder","learningplan","required","notaddingcourse","items","itemsPeriod","containercourses","btnupdatecourseorder","item","handleDragStart","handleDragEnter","handleDragOver","handleDragLeave","handleDrop","handleDragEnd","contelement","handleDropNew","clickUpdateCourses","btnupdatecourseperiodorder","btnupdate","attributes","lpid","clickUpdateCoursePeriod","courseData","listRecordID","datacourse","listCoursePosition","poscourse","listCourseID","replace","position","coursePosition","index","dragSrcEl","opacity","this","dataTransfer","effectAllowed","setData","dropEffect","stopPropagation","getData","itemToReplaceAttr","itemToReplaceCourseAttr","draggedItemAttr","draggedItemCourseAttr","setAttribute","havePeriod","_dragSrcEl$attributes","parentElement"],"mappings":"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"}