{"version":3,"file":"edit_learningplan.min.js","sources":["../src/edit_learningplan.js"],"sourcesContent":["import * as Ajax from 'core/ajax';\n\nexport const init = (learningid, is_siteadmin) => {\n    const btneditplan = document.querySelector('#edit_learning_plan');\n    if (btneditplan) {\n        btneditplan.addEventListener('click', e => {\n            e.preventDefault();\n            const learningname = document.getElementById('learningname');\n            if (!learningname.validity.valid) {\n                learningname.reportValidity();\n                return;\n            }\n            const learningshortname = document.getElementById('learningshortname');\n            const desc_plan = document.getElementById('id_desc_planeditable');\n            const learningimage = document.getElementById('id_learningplan_image');\n            if (window.NodeList && !window.NodeList.prototype.map) {\n                window.NodeList.prototype.map = Array.prototype.map;\n            }\n            const requirements = document.querySelectorAll('input[name=learningrequirements]:checked').map(el => el.value).join();\n            const customfields = [];\n            document.getElementsByClassName('customfield').forEach(({id,value}) => {\n                value? customfields.push({id,value}):undefined;\n            });\n            const promise = Ajax.call([{\n                methodname: 'local_sc_learningplans_edit_learning_plan',\n                args: {\n                    learningid: learningid,\n                    learningname: learningname.value,\n                    learningshortname: learningshortname.value,\n                    fileimage: learningimage.value,\n                    description: desc_plan.innerHTML,\n                    requirements,\n                    customfields\n                }\n            },]);\n\n            promise[0].done(function () {\n                window.console.log(is_siteadmin, 'local_sc_learningplans_edit_learning_plan');\n                if (!is_siteadmin) {\n                    window.location.href = '/';\n                }\n                else {\n                    window.location.href = '/local/sc_learningplans/index.php';\n                }\n            }).fail(function (response) {\n                window.console.error(response);\n            });\n        });\n    }\n};"],"names":["learningid","is_siteadmin","btneditplan","document","querySelector","addEventListener","e","preventDefault","learningname","getElementById","validity","valid","learningshortname","desc_plan","learningimage","window","NodeList","prototype","map","Array","requirements","querySelectorAll","el","value","join","customfields","getElementsByClassName","forEach","id","push","Ajax","call","methodname","args","fileimage","description","innerHTML","done","console","log","location","href","fail","response","error","reportValidity"],"mappings":"s3CAEoB,SAACA,WAAYC,kBACvBC,YAAcC,SAASC,cAAc,uBACvCF,aACAA,YAAYG,iBAAiB,SAAS,SAAAC,GAClCA,EAAEC,qBACIC,aAAeL,SAASM,eAAe,mBACxCD,aAAaE,SAASC,WAIrBC,kBAAoBT,SAASM,eAAe,qBAC5CI,UAAYV,SAASM,eAAe,wBACpCK,cAAgBX,SAASM,eAAe,yBAC1CM,OAAOC,WAAaD,OAAOC,SAASC,UAAUC,MAC9CH,OAAOC,SAASC,UAAUC,IAAMC,MAAMF,UAAUC,SAE9CE,aAAejB,SAASkB,iBAAiB,4CAA4CH,KAAI,SAAAI,WAAMA,GAAGC,SAAOC,OACzGC,aAAe,GACrBtB,SAASuB,uBAAuB,eAAeC,SAAQ,mBAAEC,QAAAA,GAAGL,WAAAA,MACxDA,OAAOE,aAAaI,KAAK,CAACD,GAAAA,GAAGL,MAAAA,WAEjBO,KAAKC,KAAK,CAAC,CACvBC,WAAY,4CACZC,KAAM,CACFjC,WAAYA,WACZQ,aAAcA,aAAae,MAC3BX,kBAAmBA,kBAAkBW,MACrCW,UAAWpB,cAAcS,MACzBY,YAAatB,UAAUuB,UACvBhB,aAAAA,aACAK,aAAAA,iBAIA,GAAGY,MAAK,WACZtB,OAAOuB,QAAQC,IAAItC,aAAc,6CAK7Bc,OAAOyB,SAASC,KAJfxC,aAIsB,oCAHA,OAK5ByC,MAAK,SAAUC,UACd5B,OAAOuB,QAAQM,MAAMD,kBApCrBnC,aAAaqC"}